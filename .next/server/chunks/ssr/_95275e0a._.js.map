{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/icons/GoogleIcon.tsx"],"sourcesContent":["\n// src/components/icons/GoogleIcon.tsx\nimport React from 'react';\n\nexport const GoogleIcon = () => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" width=\"24px\" height=\"24px\">\n    <path fill=\"#EA4335\" d=\"M24 9.5c3.1 0 5.9 1.1 8.1 3.1l6.3-6.3C34.4 2.8 29.5 1 24 1 14.9 1 7.1 6.4 3.1 14.5l7.7 6C12.5 14.2 17.8 9.5 24 9.5z\"/>\n    <path fill=\"#4285F4\" d=\"M46.2 25.1c0-1.6-.1-3.2-.4-4.7H24v9h12.4c-.6 2.9-2.1 5.4-4.5 7.1l7 5.5c4.1-3.8 6.7-9.2 6.7-15.4z\"/>\n    <path fill=\"#34A853\" d=\"M10.8 30.5c-.4-1.2-.6-2.5-.6-3.8s.2-2.6.6-3.8l-7.7-6C1.2 19.9 0 22.9 0 26.2s1.2 6.3 3.1 8.8l7.7-4.5z\"/>\n    <path fill=\"#FBBC05\" d=\"M24 47c5.5 0 10.4-1.8 13.8-5l-7-5.5c-1.8 1.2-4.1 1.9-6.8 1.9-6.2 0-11.5-4.7-13.4-11.1l-7.7 6C7.1 41.6 14.9 47 24 47z\"/>\n    <path fill=\"none\" d=\"M0 0h48v48H0z\"/>\n  </svg>\n);\n"],"names":[],"mappings":"AACA,sCAAsC;;;;;;AAG/B,MAAM,aAAa,kBACxB,8OAAC;QAAI,OAAM;QAA6B,SAAQ;QAAY,OAAM;QAAO,QAAO;;0BAC9E,8OAAC;gBAAK,MAAK;gBAAU,GAAE;;;;;;0BACvB,8OAAC;gBAAK,MAAK;gBAAU,GAAE;;;;;;0BACvB,8OAAC;gBAAK,MAAK;gBAAU,GAAE;;;;;;0BACvB,8OAAC;gBAAK,MAAK;gBAAU,GAAE;;;;;;0BACvB,8OAAC;gBAAK,MAAK;gBAAO,GAAE","debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/icons/index.tsx"],"sourcesContent":["\n// src/components/icons/index.tsx\nexport * from './GoogleIcon';\n// Export other icons here if needed\n"],"names":[],"mappings":"AACA,iCAAiC;;;CAEjC,oCAAoC","debugId":null}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/login/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from '@/components/ui/separator';\nimport { Loader2 } from 'lucide-react'; // For loading state\nimport { GoogleIcon } from \"@/components/icons\";\nimport {\n    getAuth,\n    signInWithPopup,\n    GoogleAuthProvider,\n    onAuthStateChanged,\n    User // Import User type\n} from \"firebase/auth\";\nimport { initializeApp, getApps, getApp } from \"firebase/app\"; // Import getApps and getApp\nimport { useRouter } from 'next/navigation';\n\n// Use environment variables for Firebase config.\n// IMPORTANT: Create a .env.local file in the root of your project and add these variables:\n// NEXT_PUBLIC_FIREBASE_API_KEY=YOUR_API_KEY\n// NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=YOUR_AUTH_DOMAIN\n// NEXT_PUBLIC_FIREBASE_PROJECT_ID=YOUR_PROJECT_ID\n// NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=YOUR_STORAGE_BUCKET\n// NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=YOUR_MESSAGING_SENDER_ID\n// NEXT_PUBLIC_FIREBASE_APP_ID=YOUR_APP_ID\n\nconst firebaseConfig = {\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\n// Initialize Firebase only once\nfunction ensureFirebaseInitialized() {\n    // Check if API key is provided and not the placeholder\n    if (!firebaseConfig.apiKey || firebaseConfig.apiKey === \"YOUR_API_KEY\") { // Removed specific key check \"AIzaSy...\"\n        const errorMsg = 'La clave API de Firebase falta o no es válida. Por favor, verifica tu archivo .env.local (NEXT_PUBLIC_FIREBASE_API_KEY) y reinicia el servidor.';\n        console.error(errorMsg, \"Raw env value:\", process.env.NEXT_PUBLIC_FIREBASE_API_KEY); // Log the raw value for debugging\n        throw new Error(errorMsg);\n    }\n    if (!getApps().length) {\n        try {\n            console.log(\"Initializing Firebase...\"); // Log initialization attempt\n            return initializeApp(firebaseConfig);\n        } catch (error: any) {\n             console.error(\"Firebase initialization error:\", error);\n             // Provide a more specific error message if possible\n             if (error.code === 'auth/invalid-api-key' || error.message.includes('invalid-api-key')) {\n                 throw new Error(\"La clave API de Firebase no es válida. Revisa la configuración en Firebase Console y tu archivo .env.local.\");\n             }\n             throw new Error(\"No se pudo inicializar Firebase. Revisa la consola para más detalles.\");\n        }\n    } else {\n        return getApp(); // Use existing app instance\n    }\n}\n\n// --- Placeholder Function for First Login Check ---\n// In a real app, this would interact with your backend/database\n// to check if the user has completed the initial setup.\nconst isFirstLogin = async (user: User): Promise<boolean> => {\n    console.log(\"Checking if first login for user:\", user.uid);\n    // Example: Check creation time vs last sign-in time.\n    // This is a common pattern but might require adjusting tolerance depending on Firebase behavior.\n    const creationTime = user.metadata.creationTime ? new Date(user.metadata.creationTime).getTime() : 0;\n    const lastSignInTime = user.metadata.lastSignInTime ? new Date(user.metadata.lastSignInTime).getTime() : 0;\n    // Consider a small tolerance (e.g., 5 seconds) as times might not be exactly equal\n    const isNew = Math.abs(creationTime - lastSignInTime) < 5000;\n    console.log(\"User metadata:\", user.metadata);\n    console.log(\"Creation time:\", creationTime, \"Last sign-in time:\", lastSignInTime);\n    console.log(\"Is considered first login?\", isNew);\n    return isNew;\n}\n// --- End Placeholder ---\n\n\nexport default function LoginPage() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const router = useRouter();\n\n  useEffect(() => {\n    // Initialize Firebase and check auth state on mount\n    try {\n        const app = ensureFirebaseInitialized();\n        const auth = getAuth(app);\n\n        // Check for existing authentication\n        const unsubscribe = onAuthStateChanged(auth, async (user) => { // Make async\n          if (user) {\n            // --- First Login Check ---\n            const firstLogin = await isFirstLogin(user); // Check if it's the first login\n            if (firstLogin) {\n               console.log(\"First login detected, redirecting to profile setup.\");\n               router.push('/profile-setup'); // Redirect to setup page\n            } else {\n                console.log(\"Existing user detected, redirecting to home.\");\n                 router.push('/'); // Redirect to home page for existing users\n            }\n            // -----------------------\n          } else {\n            console.log('No user currently logged in (onAuthStateChanged).');\n          }\n        });\n        // Cleanup subscription on unmount\n        return () => unsubscribe();\n\n    } catch (initError: any) {\n        console.error(\"Error during Firebase init or auth check:\", initError);\n        setError(initError.message || \"Error al inicializar la autenticación.\");\n    }\n  }, [router]); // Add router to dependency array\n\n\n  const handleGoogleSignIn = async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n        console.log(\"Attempting Google Sign-In...\");\n        const app = ensureFirebaseInitialized(); // Ensure initialized before getting auth\n        const auth = getAuth(app);\n        const provider = new GoogleAuthProvider();\n        // Consider adding custom parameters if needed, e.g., language preference\n        // provider.setCustomParameters({ 'login_hint': 'user@example.com' });\n        await signInWithPopup(auth, provider);\n        // onAuthStateChanged will handle the redirect after checking if it's the first login\n        console.log(\"Google Sign-In Popup successful (before onAuthStateChanged handles redirect).\");\n      } catch (error: any) { // Catch specific Firebase errors if possible\n        console.error(\"Google Sign-In Error:\", error);\n        console.error(\"Error Code:\", error.code);\n        console.error(\"Error Message:\", error.message);\n\n        if (error.code === 'auth/popup-closed-by-user') {\n             setError('Inicio cancelado. Si no cerraste la ventana, revisa si tu navegador bloquea ventanas emergentes.');\n        } else if (error.code === 'auth/cancelled-popup-request') {\n             setError('Se canceló una solicitud de inicio de sesión anterior. Intenta de nuevo.');\n        } else if (error.code === 'auth/popup-blocked') {\n             setError('El navegador bloqueó la ventana emergente de Google. Habilita las ventanas emergentes para este sitio e intenta de nuevo.');\n        } else if (error.code === 'auth/network-request-failed') {\n            setError('Error de red. Verifica tu conexión e intenta de nuevo.');\n        } else if (error.message && error.message.includes(\"La clave API de Firebase falta\")) {\n            setError(error.message); // Show the specific missing key error\n        } else if (error.code === 'auth/invalid-api-key' || error.code === 'auth/api-key-not-valid') {\n             setError('La clave API de Firebase no es válida. Verifica tu archivo .env.local y la configuración en Firebase Console.');\n        } else if (error.code === 'auth/unauthorized-domain') {\n             setError('Error: Dominio no autorizado. Asegúrate de que \"' + window.location.hostname + '\" esté en la lista de dominios autorizados en Firebase Auth.');\n        } else {\n            setError(`Error al iniciar sesión con Google: ${error.message || 'Intenta de nuevo.'} Codigo: ${error.code}`);\n        }\n      } finally { // Ensure isLoading is set to false even if there's an error\n        setIsLoading(false);\n      }\n  };\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-primary/10 via-background to-background px-4 py-12\">\n      <Card className=\"w-full max-w-md shadow-xl\">\n        <CardHeader className=\"text-center\">\n          <CardTitle className=\"text-2xl font-bold tracking-tight text-foreground\">\n            Iniciar Sesión\n          </CardTitle>\n          <CardDescription>\n            Ingresa usando tu cuenta de Google.\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\"> {/* Increased space */}\n          {error && (\n            <p className=\"text-sm font-medium text-destructive bg-destructive/10 p-3 rounded-md\">\n              {error}\n            </p>\n          )}\n\n          {/* Google Sign-In Button is the only option */}\n          <Button\n            variant=\"outline\"\n            className=\"w-full\"\n            onClick={handleGoogleSignIn}\n            disabled={isLoading}\n          >\n             {isLoading ? (\n                <Loader2 className=\"animate-spin\" />\n              ) : (\n                <>\n                 <GoogleIcon />\n                 <span className=\"ml-2\">Continuar con Google</span>\n                </>\n              )}\n          </Button>\n        </CardContent>\n         {/* Optionally keep the link to register, or remove if registration is also Google-only */}\n        {/*\n        <CardFooter className=\"flex justify-center text-sm\">\n          <p className=\"text-muted-foreground\">\n            ¿No tienes una cuenta?{' '}\n            <Link href=\"/register\" className=\"font-medium text-primary hover:underline\">\n              Regístrate aquí\n            </Link>\n          </p>\n        </CardFooter>\n         */}\n      </Card>\n    </div>\n  );\n}\n\n    "],"names":[],"mappings":"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","debugId":null}}]
}